@using MediReserva.Models
@using MudBlazor
@namespace MediReserva.Pages.Modals

<MudDialog>
    <DialogContent>
        <MudText Typo="Typo.h6">@(_medico.Id == 0 ? "Crear Médico" : "Editar Médico")</MudText>

        <MudTextField Label="Nombre" @bind-Value="_medico.Nombre" Required="true" />
        <MudTextField Label="Email" @bind-Value="_medico.Email" />
        <MudTextField Label="Teléfono" @bind-Value="_medico.Telefono" />
        <MudTextField Label="Consultorio" @bind-Value="_medico.Consultorio" />
        <MudSelect T="int" Label="Especialidad" @bind-Value="_medico.EspecialidadId" Required="true">
            @foreach (var especialidad in Especialidades)
            {
                <MudSelectItem Value="@especialidad.Id">@especialidad.Nombre</MudSelectItem>
            }
        </MudSelect>
    </DialogContent>

    <DialogActions>
        <MudButton Color="Color.Primary" OnClick="Guardar">Guardar</MudButton>
        <MudButton Color="Color.Secondary" OnClick="Cancelar">Cancelar</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] IDialogReference MudDialog { get; set; } = default!;
    [Parameter] public Medico MedicoParametro { get; set; } = new();

    private Medico _medico = new();
    private List<Especialidad> Especialidades = new();

    protected override void OnInitialized()
    {
        _medico = new Medico
            {
                Id = MedicoParametro.Id,
                Nombre = MedicoParametro.Nombre,
                Email = MedicoParametro.Email,
                Telefono = MedicoParametro.Telefono,
                Consultorio = MedicoParametro.Consultorio,
                EspecialidadId = MedicoParametro.EspecialidadId
            };

        Especialidades = new List<Especialidad>
        {
            new Especialidad { Id = 1, Nombre = "Cardiología" },
            new Especialidad { Id = 2, Nombre = "Pediatría" },
            new Especialidad { Id = 3, Nombre = "Dermatología" }
        };
    }

    private void Guardar()
    {
        MudDialog.Close(DialogResult.Ok(_medico));
    }

    private void Cancelar()
    {
        // MudDialog.Cancel();
    }
}
